#!/bin/bash

aws emr create-cluster --termination-protected --applications Name=Hadoop Name=Spark --tags 'Name=OSRM-Cluster' 'Test=1' --ec2-attributes '{"KeyName":"<YOUR KEY NAME>","InstanceProfile":"EMR_EC2_DefaultRole","SubnetId":"subnet-<YOUR CHOSEN SUBNET>","EmrManagedSlaveSecurityGroup":"sg-<YOUR MANAGED SECURITY GROUP>","EmrManagedMasterSecurityGroup":"sg-<YOUR MANAGED MASTER SECURITY GROUP>"}' --release-label emr-<LATEST RELEASE> --log-uri 's3n://<YOUR S3 BUCKET FOR LOGS>' --instance-groups '[{"InstanceCount":1,"BidPrice":"1","EbsConfiguration":{"EbsBlockDeviceConfigs":[{"VolumeSpecification":{"SizeInGB":50,"VolumeType":"gp2"},"VolumesPerInstance":1}],"EbsOptimized":true},"InstanceGroupType":"MASTER","InstanceType":"m4.2xlarge","Name":"Master - 1"},{"InstanceCount":2,"BidPrice":"1","EbsConfiguration":{"EbsBlockDeviceConfigs":[{"VolumeSpecification":{"SizeInGB":50,"VolumeType":"gp2"},"VolumesPerInstance":1}],"EbsOptimized":true},"InstanceGroupType":"CORE","InstanceType":"m4.2xlarge","Name":"Core - 2"}]' --auto-scaling-role EMR_AutoScaling_DefaultRole --bootstrap-actions '[{"Path":"s3://<PATH TO WHERE YOU PUT THE BOOTSTRAP FILE ON S3>","Name":"Add OSRM"}]' --service-role EMR_DefaultRole --enable-debugging --name 'OSRM Cluster' --scale-down-behavior TERMINATE_AT_INSTANCE_HOUR --region us-east-1